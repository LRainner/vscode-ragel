{
  "name": "Ragel",
  "scopeName": "source.ragel",
  "patterns": [
    { "include": "#comments" },
    { "include": "#strings" },
    { "include": "#keywords" },
    { "include": "#operators" },
    { "include": "#actions" },
    { "include": "#machines" },
    { "include": "#states" },
    { "include": "#embedded-code" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.number-sign.ragel",
          "match": "#.*$"
        },
        {
          "name": "comment.block.ragel",
          "begin": "/\\*",
          "end": "\\*/"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.single.ragel",
          "begin": "'",
          "end": "'",
          "patterns": [
            {
              "name": "constant.character.escape.ragel",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "string.quoted.double.ragel",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.ragel",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.ragel",
          "match": "\\b(machine|action|alphtype|getkey|access|variable|write|export|include|import|prepush|postpop|when|inwhen|outwhen|err|lerr|eof|noerror|nofinal|noprefix|noend)\\b"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.ragel",
          "match": "(:=|=|\\||&|-|\\*|\\?|\\+|!|\\^|\\.\\.|\\$|%|>|<|@|//)"
        }
      ]
    },
    "actions": {
      "patterns": [
        {
          "name": "entity.name.function.ragel",
          "match": "\\baction\\s+(\\w+)\\b",
          "captures": {
            "1": { "name": "entity.name.function.ragel" }
          }
        }
      ]
    },
    "machines": {
      "patterns": [
        {
          "name": "entity.name.class.ragel",
          "match": "\\bmachine\\s+(\\w+)\\b",
          "captures": {
            "1": { "name": "entity.name.class.ragel" }
          }
        }
      ]
    },
    "states": {
      "patterns": [
        {
          "name": "variable.other.ragel",
          "match": "\\b(\\w+)\\s*="
        }
      ]
    },
    "embedded-code": {
      "patterns": [
        {
          "name": "meta.embedded.block.c",
          "begin": "\\{",
          "end": "\\}",
          "patterns": [
            { "include": "source.c" }
          ]
        }
      ]
    }
  }
} 